-- File: supabase/migrations/20250103120000_add_assignment_date.sql

-- Add assignment_date column to assignments table
ALTER TABLE assignments ADD COLUMN assignment_date DATE;
ALTER TABLE assignments ADD COLUMN subject TEXT;
-- Create a new policy for inserting assignments
CREATE POLICY "Allow insert for authenticated users"
  ON assignments
  FOR INSERT
  WITH CHECK (auth.uid() IS NOT NULL); 
  
-- File: supabase/migrations/20250103120002_create_assignment_files_relationship.sql

-- Create foreign key relationship between assignments and assignment_files
ALTER TABLE assignment_files
ADD CONSTRAINT fk_assignment
FOREIGN KEY (assignment_id) REFERENCES assignments(id) ON DELETE CASCADE;